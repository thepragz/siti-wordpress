!function(a,b,c){"use strict";function d(b){var c=a(b),d=c.data("popmake"),e=a("form",c);e.length&&!a('[name="popmake_pa_conversion_check"]',e).length&&(e.find(".gform_body").length||e.hasClass("ninja-forms-form")||e.hasClass("wpcf7-form"))&&(e.addClass("popmake_pa"),e.append('<input type="hidden" name="_popmake_pa_conversion_check" value="'+d.id+'"/>'),e.append('<input type="hidden" name="_popmake_pa_open_event_id" value=""/>'),e.bindFirst("submit",function(){a('[name="_popmake_pa_open_event_id"]',e).val(c.data("open-event-id")),a.fn.popmake.conversion_trigger=e.attr("id")||a.fn.popmake.utilities.getXPath(e)}))}function e(){a(b).trigger("pumConversion")}a.fn.popmake.conversion_trigger=null,a.fn.bindFirst===c&&(a.fn.bindFirst=function(b,c){var e,f,d=a(this);d.unbind(b,c),d.bind(b,c),e=a._data(d[0]).events,f=e[b],f.unshift(f.pop()),e[b]=f}),a.fn.outerHtml===c&&(a.fn.outerHtml=function(){var b=a(this).clone(),c=a("<div/>").append(b);return c.html()}),a(b).on("pumConversion",function(){var b=PUM.getPopup(a.fn.popmake.last_open_popup),c={action:"popmake_pa",popup_id:b.data("popmake").id,event_type:"conversion",open_event_id:b.data("open-event-id"),trigger:a.fn.popmake.conversion_trigger,_ajax_nonce:popmake_pa_nonce};a.ajax({type:"POST",dataType:"json",url:ajaxurl,async:!1,data:c})}),a(".pum").on("pumInit",function(){var b=PUM.getPopup(this),f=b.data("popmake"),g=f.meta.convert_on;if(d(this),g!==c&&""!==g)switch(g){case"form_submit":b.find("form").filter(":not(.popmake_pa)").on("submit.popmake_pa",function(){a.fn.popmake.conversion_trigger=a(this).attr("id")||"Form Submit",e(),a(this).off("submit.popmake_pa")});break;case"button_click":b.find("button, .button, .btn").on("click",function(){console.log(a(this)),a.fn.popmake.conversion_trigger=a(this).attr("id")||"Button Click",e()});break;case"link_click":b.find("a").on("click",function(){a.fn.popmake.conversion_trigger=a(this).attr("id")||"Link Click",e()})}}).on("pumBeforeOpen.analytics",function(){var b=PUM.getPopup(this),c={action:"popmake_pa",popup_id:b.data("popmake").id,event_type:"open",trigger:null,_ajax_nonce:popmake_pa_nonce},d=null;try{d=a(a.fn.popmake.last_open_trigger)}catch(b){d=a()}d.length?c.trigger=d.eq(0).outerHtml():null!==a.fn.popmake.last_open_trigger&&(c.trigger=a.fn.popmake.last_open_trigger.toString()),a.ajax({type:"POST",dataType:"json",url:ajaxurl,data:c,success:function(a){a.success&&a.event_id>0?b.data("open-event-id",a.event_id):b.data("open-event-id",null)}}),a(window).one("unload.popmake_pa",function(){c={action:"popmake_pa",popup_id:b.data("popmake").id,event_type:"close",open_event_id:b.data("open-event-id"),trigger:"Browser Closed",_ajax_nonce:popmake_pa_nonce},a.ajax({type:"POST",dataType:"json",url:ajaxurl,async:!1,data:c})})}).on("pumBeforeClose.analytics",function(){var b=PUM.getPopup(this),c={action:"popmake_pa",popup_id:b.data("popmake").id,event_type:"close",open_event_id:b.data("open-event-id"),trigger:a.fn.popmake.last_close_trigger,_ajax_nonce:popmake_pa_nonce};a(window).off("unload.popmake_pa"),a.ajax({type:"POST",dataType:"json",url:ajaxurl,data:c})})}(jQuery,document);